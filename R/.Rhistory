#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
ggplot(aes(get(option), fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
scale_x_discrete(str_replace_all(DRG$Code, " - ", ""))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x = element_text(angle = 90, size = 3),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
ggplot(aes(get(option), fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
scale_y_discrete(str_replace_all(DRG$Code, " - ", ""))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x = element_text(angle = 90, size = 3),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
ggplot(aes(get(option), fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
scale_y_discrete(str_replace_all(DRG$Code, " - ", ""))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.y = element_text(angle = 90, size = 3),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
ggplot(aes(get(option), fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x =  = element_text(angle = 90, size = 3),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
ggplot(aes(get(option), fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x  = element_text(angle = 90, size = 3),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
ggplot(aes(get(option), Code, fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x  = element_text(angle = 90, size = 3),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
ggplot(aes(get(option), Code, fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x  = element_text(angle = 90, size = 3),
panel.grid = element_blank(),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
ggplot(aes(reorder(get(option), Code), fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x  = element_text(angle = 90, size = 3),
panel.grid = element_blank(),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
ggplot(aes(reorder(get(option), Code), fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x  = element_text(angle = 90, size = 3),
panel.grid = element_blank(),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
arrange(desc(get(option))) %>%
ggplot(aes(get(option), Code, fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x  = element_text(angle = 90, size = 3),
panel.grid = element_blank(),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
arrange(get(option), Code) %>%
ggplot(aes(get(option), Code, fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x  = element_text(angle = 90, size = 3),
panel.grid = element_blank(),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
arrange(Code, get(option)) %>%
ggplot(aes(get(option), Code, fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x  = element_text(angle = 90, size = 3),
panel.grid = element_blank(),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
View(DRG)
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
group_by(Code) %>%
arrange(desc(get(option))) %>%
ggplot(aes(get(option), Code, fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x  = element_text(angle = 90, size = 3),
panel.grid = element_blank(),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
ggplot(aes(get(option), Code, fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x  = element_text(angle = 90, size = 5),
panel.grid = element_blank(),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
ggplot(aes(get(option), Code, fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x  = element_text(angle = 90, size = 4),
panel.grid = element_blank(),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
ggplot(aes(get(option), Code, fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x  = element_text(angle = 90, size = 4, hjust = 1),
panel.grid = element_blank(),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
ggplot(aes(get(option), Code, fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.text.x  = element_text(angle = 90, size = 4.5, hjust = 1),
panel.grid = element_blank(),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
ggplot(aes(get(option), Code, fill = Code))+
geom_boxplot()+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.title.x = element_blank(),
axis.text.x  = element_text(angle = 90, size = 4.5, hjust = 1),
panel.grid = element_blank(),
legend.position = "none")
plt
}
drg_plot(option = "Average.Medicare.Payments")
drg_plot(option = "Average.Covered.Charges")
drg_plot(option = "Average.Total.Payments")
#' @export
#'
#' @import tidyverse
#' @import tidyr
#' @import ggplot2
#' @import stringr
#' @import ggdark
#' @importFrom magrittr %>%
#'
#' @examples
drg_plot <- function(option) {
if (missing(option)) { stop("Please specify a valid option argument") }
plt <- DRG %>%
ggplot(aes(get(option), Code, fill = Code))+
geom_boxplot(outlier.size = 0.2)+
dark_theme_minimal()+
coord_flip()+
xlab(paste0(str_replace_all(option, "[[:punct:]]", " "), " (USD)"))+
ggtitle(label = paste0("Boxplots for The ", str_replace_all(option, "[[:punct:]]", " "), " (USD) Distribution"))+
theme(plot.title = element_text(face = "bold"),
axis.ticks.x = element_blank(),
axis.title.x = element_blank(),
axis.text.x  = element_text(angle = 90, size = 4.5, hjust = 1),
panel.grid = element_blank(),
legend.position = "none")
plt
}
drg_plot(option = "Average.Total.Payments")
